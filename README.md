# toretate-marche

## サービス概要
高齢の農家さんや家庭菜園の生産者が、スマホで簡単に出品できる直売アプリ。
消費者は「地域×旬」で新鮮な農産物を直接購入できる。
生産者と消費者を“あたたかく”つなぐ、地域密着型のエシカルECプラットフォーム。

## このサービスへの思い・作りたい理由
実家が果物農家（野菜も少々）で、両親が今日明日で販売したいけれど販売先が見つからないことで、私に宣伝依頼をすることが多くSNSやホームぺージなどで
販売促進をしていましたが、私を介さずにダイレクトに消費者に伝わる仕組みがあればスムーズな販売ができると思いました。
また私の家族や地元には農業を営む高齢者が多く、「せっかく美味しい野菜ができても販路がない」「出荷作業が面倒で続けられない」という声を聞いてきました。
一方で都市部では「顔が見える野菜が欲しい」「地域を応援したい」という風潮があるように思います。
このギャップを埋め、「誰でも・気軽に・地域とつながりながら」販売できる仕組みを作りたいと思ったのが「とれたてマルシェ」を構想したきっかけです。
高齢者や小規模農家が、無理なく社会参加できる“新しい形の直売所”をテクノロジーで実現したいと思っています。

## ユーザー層について

① 個人農家・家庭菜園ユーザー
② 地元の消費者・子育て世帯

## サービスの利用イメージ
生産者側
 　スマホやタブレットで「きゅうり10袋、1袋200円」と投稿だけで出品。
 　WEBアプリで自動で商品情報を生成し、購入希望が入ると通知が届く。
 　ラベルを貼って出荷するだけで、販売完了。

消費者側
 　地域や旬の野菜をアプリで検索し、生産者のプロフィールや畑の写真を見ながら購入。
 　届いた後はレビューや「ありがとうメッセージ」を投稿できる。
 　“地域の人を応援する買い物”が自然にできる。

→ 結果として、生産者は負担少なく収益化でき、消費者は信頼と安心を得る。

## ユーザーの獲得について
①生産者
農家・自治体・道の駅・直売所での宣伝
②消費者
Instagram・X・YouTubeで発信

実際にこのサービスを使ってもらえる予定としては、まずは農業を営む父親にお願いしたいと思っています。
実際に開発したアプリを使ってもらって感想を聞いて、その次に地元の道の駅などにて運営側の方に相談したいと思います。


## サービスの差別化ポイント・推しポイント
食べチョクやレット、らでぃっしゅぼーやなどの競合と違い、タイムライン機能をつけて
SNS（Xやインスタ）やメッセージアプリ（LINE）のような機能をつけて
コミュニケーションが近くリアルタイムな売買ができる

## 機能候補
現状作ろうと思っている機能、案段階の機能案として

①生産者・・・　投稿作成機能（出品）　タイムライン（投稿）　プロフィール（自己紹介、アイコン）　購入通知　　ログイン機能（メールアドレス・パスワード）　

②消費者・・・　購入　　　タイムライン（コメントのみ）　　ログイン機能（メールアドレス・パスワード）　  検索（地域/品目/旬タグ）

③管理者・・・　購入履歴　ログイン機能（メールアドレス・パスワード）　

##実装方法のイメージ｜購入機能について

現時点での実装予定としては

「payjp 」を使用した
- クレジットカード決済
- カート機能
- 商品購入機能


## 使用する技術スタック
現状考えているもの

- 使用するフレームワーク（Ruby on Rails ）
- データベース（MySQLなど）
- デプロイ先（Render）

- 使用予定のライブラリ（Devise payjp pg_search など）

# 画面遷移図

https://www.figma.com/design/kEJNQwCEt5VncPkwK2NaWH/20251108-10--%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3-?node-id=2061-1739&p=f&t=EX8rS4em1Jzqlmv0-0

# ER図
https://gyazo.com/5fc29772ec3f96a5c15eb44dfed2ed06

### 本サービスの概要（700文字以内） 
「とれたてマルシェ」は、近隣の小規模生産者が“今日採れた”野菜や果物を気軽に出品し、消費者が写真を見てそのまま購入できる直売アプリです。SNS感覚のシンプルな閲覧体験と、1商品＝単発購入の最小フローに絞ることで、高齢の生産者でも運用しやすく、消費者は迷わず買えるのが特徴です。想定ユーザーは〔生産者：出品・在庫管理を最低限で運用したい個人農家〕〔消費者：地元の新鮮食材を手軽に購入したい家族層〕。MVPではユーザー登録、商品一覧・詳細、画像選択つきの注文確定までを提供し、決済は案内ベース（振込）とします。注文時点の価格・画像をスナップショット保存し、在庫を自動減算。まずは実家農園を唯一の出品者として運用し、将来的な多店舗化に耐える設計を採用します。


### MVPで実装する予定の機能 ※ MVP（Minimum Viable Product：最小限の実用的な製品）として実装予定の機能

- 認証：メール＋パスワード登録/ログイン、ログアウト
- 役割：users.role（1:seller, 2:buyer）で権限制御
- 商品：sellerによる商品登録/編集/公開・在庫数管理、画像添付（Active Storage）
- 一覧/詳細：公開商品のタイムライン表示、詳細で画像選択
- 注文：単一商品の購入フロー（数量入力→確認→確定）
- スナップショット：unit_price_snapshot・selected_image_key の保存、total_amount計算
- 在庫連動：確定時にstock_quantityを減算（0でsold_out）
- 注文状態：status（0:pending, 1:confirmed, 2:canceled）とplaced_at
- 管理（簡易）：sellerの自分の商品/注文のみ閲覧


### users（ユーザー情報）
| カラム名 | 型 | 説明 |
|-----------|----|------|
| id | bigint | PK |
| email | string | ログイン用メールアドレス（ユニーク制約 / NOT NULL） |
| encrypted_password | string | パスワード（Deviseによる暗号化 / NOT NULL） |
| name | string | 表示名（例：浅野農園・佐藤花子など） |
| role | integer | ユーザー種別（1:seller／2:buyer） |
| created_at | datetime | 登録日時 |
| updated_at | datetime | 更新日時 |

🗂 **インデックス**：email（unique）, role

---

### products（商品情報）
| カラム名 | 型 | 説明 |
|-----------|----|------|
| id | bigint | PK |
| seller_id | bigint | 出品者ID（FK：users.id） |
| title | string | 商品タイトル（例：朝採れトマト） |
| description | text | 商品説明（例：完熟トマトを朝収穫しました） |
| price | integer | 価格（単位：円） |
| stock_quantity | integer | 在庫数 |
| status | integer | 商品状態（0:draft／1:published／2:sold_out） |
| created_at | datetime | 登録日時 |
| updated_at | datetime | 更新日時 |

📎 **画像**：Active Storageを利用（`has_many_attached :images`）  
🗂 **インデックス**：seller_id, status

---

### orders（注文情報）
| カラム名 | 型 | 説明 |
|-----------|----|------|
| id | bigint | PK |
| buyer_id | bigint | 購入者ID（FK：users.id） |
| seller_id | bigint | 出品者ID（FK：users.id） |
| product_id | bigint | 商品ID（FK：products.id） |
| quantity | integer | 注文数 |
| unit_price_snapshot | integer | 注文時点の単価（価格固定のため） |
| total_amount | integer | 合計金額（quantity × unit_price_snapshot） |
| selected_image_key | string | 選択画像のキーまたはURL（任意） |
| status | integer | 注文状態（例：0:pending, 1:confirmed, 2:shipped など拡張予定） |
| created_at | datetime | 登録日時 |
| updated_at | datetime | 更新日時 |

🗂 **インデックス**：buyer_id, seller_id, product_id

---

### 備考
- MVP段階では **配送情報・決済情報は未実装**（決済は銀行振込案内のみ）  
- Active Storageを利用し、商品画像を複数枚登録可能  
- seller と buyer は同じ `users` テーブルで role により区別  
- MVP段階では実家の農園（seller 1件）のみ登録を想定


### ER図の注意点（チェック項目）
- [ ] プルリクエストに最新のER図のスクリーンショットを画像が表示される形で掲載できている
- [ ] テーブル名は複数形になっている
- [ ] カラムの型は記載されている
- [ ] 外部キーは適切に設けられている
- [ ] リレーションは適切に描かれているか？多対多の関係は存在しない
- [ ] STIは使用しないER図になっている
- [ ] Postsテーブルにpost_nameのように"テーブル名+カラム名"を付けていないか


